<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Checkout Page</title>
</head>
<body>
<form>
    <div>
        <label>Credit Card Number</label>
        <input data-rebilly="pan">
    </div>
    <div>
        <label>Expiry Year</label>
        <input type="number" data-rebilly="expYear" placeholder="2018">
    </div>
    <div>
        <label>Expiry Month</label>
        <input type="number" data-rebilly="expMonth" placeholder="12">
    </div>
    <div>
        <label>CVV</label>
        <input type="number" data-rebilly="expMonth" placeholder="123">
    </div>
    <button type="submit">Pay</button>
</form>
<script src="../dist/rebilly.js"></script>
<script>
    (function(){
        // insert the signature generated on the server-side
        Rebilly.setAuth('eyJSRUItQVBJVVNFUiI6IjBwb3UvRmpQcSIsIlJFQi1OT05DRSI6IlhMQlI1WGpqZnZIZzlUWlN0ek1CZG4wTGpSSXhTbyIsIlJFQi1USU1FU1RBTVAiOjE1MDcxNDQ3Njg4NjgsIlJFQi1TSUdOQVRVUkUiOiJmMzI0YzkxNjEyYjc2ZDkyOTc4Mzc1ODYwY2I3OGM1ZTIyMTg1NDkzIn0=');

        var form = document.getElementsByTagName('form')[0];
        var button = document.getElementsByTagName('button')[0];
        var callback = function(response) {
            if (response.error) {
                //there was a validation or request error
                console.error(response.message);
                button.removeAttribute('disabled');
            }
            else {
                // create a hidden input field
                var tokenField = document.createElement('input');
                tokenField.setAttribute('type', 'hidden');
                tokenField.setAttribute('name', 'payment-token');
                tokenField.value = response.data.id;
                // append to the form and submit to the server
                form.appendChild(tokenField);
                form.submit();
            }
        };

        button.addEventListener('click', function(evt){
            Rebilly.createToken(form, callback);
            evt.preventDefault();
            this.setAttribute('disabled', 'disabled');
        });
    })();
</script>
</body>
</html>
